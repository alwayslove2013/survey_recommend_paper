{"version":3,"sources":["Views/NodeView/index.js","Views/DetailView/index.js","Views/RecommendView/index.js","App.js","reportWebVitals.js","index.js"],"names":["scale","d3","color","d","type","NodeView","React","memo","data","setSelectedNode","nodes","links","console","log","useState","clientWidth","setClientWidth","clientHeight","setClientHeight","useEffect","clientRect","node","getBoundingClientRect","width","height","simulation","force","id","svg","selectAll","remove","link","append","attr","join","style","on","e","handleClick","call","event","active","alphaTarget","restart","subject","fx","x","fy","y","drag","highlightSet","Set","cite_list","cited_list","has","dd","source","target","className","DetailView","selectedNode","title","doi","author","year","RecommendView","cite_node_list","cited_node_list","map","App","setData","a","filter","length","nodeSet","forEach","cite_doi","push","getData","indexOf","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8a66083c.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./index.scss\";\nimport * as d3 from \"d3\";\n\nconst scale = d3.scaleOrdinal(d3.schemeCategory10);\nconst color = (d) => scale(d.type);\n\nconst drag = (simulation) => {\n  const dragstarted = (event) => {\n    if (!event.active) simulation.alphaTarget(0.3).restart();\n    event.subject.fx = event.subject.x;\n    event.subject.fy = event.subject.y;\n  };\n\n  const dragged = (event) => {\n    event.subject.fx = event.x;\n    event.subject.fy = event.y;\n  };\n\n  const dragended = (event) => {\n    if (!event.active) simulation.alphaTarget(0);\n    event.subject.fx = null;\n    event.subject.fy = null;\n  };\n\n  return d3\n    .drag()\n    .on(\"start\", dragstarted)\n    .on(\"drag\", dragged)\n    .on(\"end\", dragended);\n};\n\nconst NodeView = React.memo(({ data, setSelectedNode }) => {\n  const { nodes, links } = data;\n\n  console.log(nodes, links);\n\n  const [clientWidth, setClientWidth] = useState(0);\n  const [clientHeight, setClientHeight] = useState(0);\n  // const xPos = d3.scaleLinear().domain([1990, 2020]).range([0, clientWidth]);\n  // nodes.forEach(node => {\n  //   node.fx =  node.data.year ? xPos(node.data.year) : null\n  // })\n  useEffect(() => {\n    const clientRect = d3.select(\".NodeView\").node().getBoundingClientRect();\n    setClientWidth(clientRect.width);\n    setClientHeight(clientRect.height);\n  }, []);\n\n  const simulation = d3\n    .forceSimulation(nodes)\n    .force(\n      \"link\",\n      d3.forceLink(links).id((d) => d.id)\n    )\n    .force(\"charge\", d3.forceManyBody())\n    .force(\"center\", d3.forceCenter(clientWidth / 2, clientHeight / 2));\n\n  const svg = d3.select(\"#node-view-svg\");\n\n  svg.selectAll(\"*\").remove();\n\n  const linkG = svg.append(\"g\").attr(\"id\", \"link-g\").attr(\"stroke\", \"#999\");\n  const link = linkG\n    .selectAll(\"line\")\n    .data(links)\n    .join(\"line\")\n    .attr(\"stroke-width\", 1)\n    .attr(\"stroke-opacity\", 0.6)\n    .attr(\"pointer-events\", \"none\");\n\n  const nodeG = svg\n    .append(\"g\")\n    .attr(\"id\", \"node-g\")\n    .attr(\"stroke\", \"#fff\")\n    .attr(\"stroke-width\", 1.5);\n  const node = nodeG\n    .selectAll(\"circle\")\n    .data(nodes)\n    .join(\"circle\")\n    .attr(\"id\", (d) => d.id)\n    .attr(\"r\", 5)\n    .attr(\"fill\", color)\n    .style(\"cursor\", \"pointer\")\n    .on(\"click\", (e, d) => {\n      // console.log(\"d\", d);\n      setSelectedNode(d);\n      handleClick(d);\n    })\n    .call(drag(simulation));\n  const handleClick = (d) => {\n    const highlightSet = new Set([...d.cite_list, ...d.cited_list, d.id]);\n    // console.log(\"highlightSet\", node, highlightSet);\n    d3.selectAll(\"circle\").attr(\"opacity\", (d) =>\n      highlightSet.has(d.id) ? 1 : 0.2\n    );\n    d3.selectAll(\"line\").attr(\"stroke-opacity\", (dd) =>\n      dd.source.id == d.id || dd.target.id == d.id ? 0.6 : 0.1\n    );\n  };\n  simulation.on(\"tick\", () => {\n    link\n      .attr(\"x1\", (d) => d.source.x)\n      .attr(\"y1\", (d) => d.source.y)\n      .attr(\"x2\", (d) => d.target.x)\n      .attr(\"y2\", (d) => d.target.y);\n    node.attr(\"cx\", (d) => d.x).attr(\"cy\", (d) => d.y);\n  });\n\n  return (\n    <div className=\"NodeView\">\n      <svg width=\"100%\" height=\"100%\" id=\"node-view-svg\" />\n    </div>\n  );\n});\n\nexport default NodeView;\n","import React from \"react\";\n\nconst DetailView = React.memo(({ selectedNode }) => {\n  const { id, data = {}, cited_list = [] } = selectedNode;\n  // console.log(id, data, cited_list);\n  return (\n    <div className=\"DetailView\">\n      <div>title: {data.title}</div>\n      <div>doi: {data.doi || id}</div>\n      <div>author: {data.author}</div>\n      <div>year: {data.year}</div>\n    </div>\n  );\n});\n\nexport default DetailView;\n","import React from \"react\";\nimport './index.scss';\n\nconst RecommendView = React.memo(({ cite_node_list, cited_node_list }) => {\n  console.log(cite_node_list, cited_node_list);\n  return <div className=\"RecommendView\">\n    <div>\n      cite:\n    </div>\n    {cite_node_list.map(node => (<div key={node.id}>\n      {node.data.title || node.id}\n    </div>))}\n    <br/>\n    <div>\n      cited:\n    </div>\n    {cited_node_list.map(node => (<div key={node.id}>\n      {node.data.title}\n    </div>))}\n  </div>;\n});\n\nexport default RecommendView;\n","import \"./App.scss\";\nimport NodeView from \"./Views/NodeView\";\nimport DetailView from \"./Views/DetailView\";\nimport RecommendView from \"./Views/RecommendView\";\nimport * as d3 from \"d3\";\nimport React, { useState, useEffect } from \"react\";\n\nfunction App() {\n  const [data, setData] = useState({\n    nodes: [],\n    links: [],\n  });\n  useEffect(() => {\n    const getData = async () => {\n      let nodes = await d3.json(\"[20201228]survey_nodes.json\");\n      nodes = nodes.filter(\n        (node) => node.type === \"in_survey\" || node.cited_list.length > 3\n      );\n      const nodeSet = new Set(nodes.map((node) => node.id));\n      const links = [];\n      nodes.forEach((node) => {\n        if (node.type === \"in_survey\") {\n          node.cite_list.forEach(\n            (cite_doi) =>\n              nodeSet.has(cite_doi) &&\n              links.push({\n                source: node.id,\n                target: cite_doi,\n              })\n          );\n        }\n      });\n      setData({\n        nodes,\n        links,\n      });\n    };\n    getData();\n  }, []);\n  const [selectedNode, setSelectedNode] = useState({});\n  console.log(\"select\", selectedNode);\n  const cite_node_list = data.nodes.filter(\n    (node) => (selectedNode.cite_list || []).indexOf(node.id) > -1\n  );\n  const cited_node_list = data.nodes.filter(\n    (node) => (selectedNode.cited_list || []).indexOf(node.id) > -1\n  );\n  return (\n    <div className=\"App\">\n      <div className=\"NodeViewContainer\">\n        <NodeView data={data} setSelectedNode={setSelectedNode} />\n      </div>\n      <div className=\"RecommendViewContainer\">\n        <RecommendView\n          cite_node_list={cite_node_list}\n          cited_node_list={cited_node_list}\n        />\n      </div>\n      <div className=\"DetailViewContainer\">\n        <DetailView selectedNode={selectedNode} />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}